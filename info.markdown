There are many more people who have the solutions that may have a better logic like
https://github.com/xfbs/PiL3